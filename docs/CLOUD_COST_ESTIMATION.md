# クラウドリソース見積書

## 内部統制テスト評価AIシステム

**作成日:** 2026年2月
**バージョン:** 9.0
**対象システム:** 内部統制テスト評価AI（ic-test-ai-agent）
**対応プラットフォーム:** Azure / GCP / AWS

---

## 目次

- [Part 1: Azure](#part-1-azure)
- [Part 2: GCP (Google Cloud Platform)](#part-2-gcp-google-cloud-platform)
- [Part 3: AWS (Amazon Web Services)](#part-3-aws-amazon-web-services)
- [Part 4: プラットフォーム比較](#part-4-プラットフォーム比較)
- [Part 5: PoC・本番環境 詳細見積もり（精緻版）](#part-5-poc本番環境-詳細見積もり精緻版)
- [Part 8: 監視サービスコスト詳細（Phase 3対応）](#part-8-監視サービスコスト詳細phase-3対応)

---

# Part 1: Azure

## 1. システム概要

### 1.1 システムの目的

本システムは、内部統制テストの評価業務をAIで自動化するものです。Excelに入力されたテスト項目と証跡ファイルをクラウドAPIに送信し、AI（LLM）による評価結果を取得してExcelに書き戻します。

### 1.2 アーキテクチャ概要

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              ユーザー環境                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   Excel + VBAマクロ                                                         │
│        │                                                                    │
│        ├─── [POWERSHELLモード] PowerShellスクリプト経由                      │
│        ├─── [VBAモード] VBA COMオブジェクト経由                              │
│        └─── [EXPORTモード] JSONファイル手動交換 → Webブラウザ                │
│                                                                             │
│   ※ ハイライト済み証跡ファイルをローカルに保存・ハイパーリンク表示           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    │ HTTPS (TLS 1.2+)
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Azure クラウド                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   ┌─────────────────┐                                                       │
│   │ Azure APIM      │ ← API Gateway（認証・レート制限・ログ）              │
│   │ (Consumption)   │                                                       │
│   └────────┬────────┘                                                       │
│            ▼                                                                │
│   ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐        │
│   │ Container Apps  │───▶│ Azure AI Foundry│    │ Azure Document  │        │
│   │ (API ホスト)    │    │ (LLM処理)       │    │ Intelligence    │        │
│   └─────────────────┘    └─────────────────┘    │ (OCR処理)       │        │
│           │                                      └─────────────────┘        │
│           │  ※ 証跡ハイライト処理                                          │
│           │    (PyMuPDF/openpyxl/reportlab)                                 │
│           ▼                                                                 │
│   ┌─────────────────────────────────────────┐                              │
│   │ Azure Storage (非同期モード時)           │                              │
│   │ - Table Storage (ジョブ状態)            │                              │
│   │ - Queue Storage (ジョブキュー)          │                              │
│   │ - Blob Storage  (証跡+ハイライト済み)   │                              │
│   └─────────────────────────────────────────┘                              │
│                                                                             │
│   ┌─────────────────┐    ┌─────────────────┐                               │
│   │ Azure AD        │    │ Azure Key Vault │ ← APIキー・接続文字列         │
│   │ (認証・認可)    │    │ (シークレット)  │                               │
│   └─────────────────┘    └─────────────────┘                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 動作モード一覧

### 2.1 クライアント実行モード

| モード | 説明 | 必要な権限 | 推奨環境 |
|--------|------|-----------|---------|
| **POWERSHELL** | PowerShellスクリプト経由でAPI呼び出し | PowerShell実行権限 | 標準環境（推奨） |
| **VBA** | VBA COMオブジェクト経由でAPI呼び出し | COM オブジェクト使用権限 | PowerShell禁止環境 |
| **EXPORT** | JSONファイルエクスポート＋Webブラウザ | ファイル保存権限のみ | 最高セキュリティ環境 |

### 2.2 サーバー処理モード

| モード | 説明 | タイムアウト | 推奨用途 |
|--------|------|-------------|---------|
| **同期** | API呼び出しで即時応答を待機 | 最大230秒 | 少量データ（10項目以下） |
| **非同期** | ジョブID返却→ポーリングで結果取得 | 制限なし | 大量データ、504タイムアウト対策 |

### 2.3 モード組み合わせマトリクス

| クライアントモード | 同期処理 | 非同期処理 |
|-------------------|---------|-----------|
| POWERSHELL | ✅ 対応 | ✅ 対応（推奨） |
| VBA | ✅ 対応 | ✅ 対応 |
| EXPORT | ✅ 対応 | ✅ 対応 |

---

## 3. 必要なAzureリソース

### 3.1 必須リソース（全モード共通）

| リソース | Azure サービス名 | SKU/プラン | 用途 |
|---------|-----------------|-----------|------|
| APIホスティング | Azure Container Apps | Consumption | REST API エンドポイント（Docker + FastAPI） |
| LLM処理 | Azure AI Foundry | Standard | AI評価（GPT-5.2等） |
| OCR処理 | Azure Document Intelligence | S0 | PDF・画像からのテキスト抽出 |
| ファイル保存 | Azure Storage Account | Standard LRS | 一時ファイル、ログ |

### 3.2 非同期モード追加リソース

| リソース | Azure サービス名 | SKU/プラン | 用途 |
|---------|-----------------|-----------|------|
| ジョブ状態管理 | Azure Table Storage | Standard | ジョブID、ステータス、結果保存 |
| ジョブキュー | Azure Queue Storage | Standard | 処理待ちジョブの管理 |
| 大容量ファイル | Azure Blob Storage | Standard | 大きな証跡ファイルの一時保存 |

### 3.3 本番環境推奨リソース（実装済み）

| リソース | Azure サービス名 | SKU/プラン | 用途 |
|---------|-----------------|-----------|------|
| API管理 | **Azure API Management** | **Consumption** | レート制限、認証、ログ集約 |
| シークレット管理 | **Azure Key Vault** | **Standard** | APIキー・接続文字列の安全な保存 |
| ユーザー認証 | Azure Active Directory | Free / P1 | OAuth 2.0 認証 |
| アプリ登録 | App Registration | - | クライアント認証設定 |

> **注:** APIM と Key Vault は Terraform IaC で定義済み（`infrastructure/azure/terraform/`）。
> 本番環境では必須のセキュリティ層として導入されています。

### 3.4 監視・ログリソース（本番環境必須）

| リソース | Azure サービス名 | SKU/プラン | 用途 |
|---------|-----------------|-----------|------|
| APM・ログ収集 | Application Insights | Basic / Standard | Container Apps 監視、トレース |
| ログ分析 | Log Analytics Workspace | 従量課金 | 統合ログ保存・クエリ |
| メトリクス・アラート | Azure Monitor | 従量課金 | アラート通知 |
| 診断ログ | Diagnostic Settings | - | AI Foundry/DI のログ収集 |

### 3.5 オプションリソース

| リソース | Azure サービス名 | SKU/プラン | 用途 |
|---------|-----------------|-----------|------|
| Webフロントエンド | Azure Static Web Apps | Free / Standard | EXPORTモード用WebUI |

> **注:** APIM・Key Vault は v8.0 で「3.3 本番環境推奨リソース」に移動しました。

### 3.6 証跡ハイライト処理

評価結果に基づき、証跡ファイル（PDF・Excel・テキスト）の該当箇所をサーバー側でハイライトし、
Base64エンコードしてクライアントに返却します。

| 処理 | ライブラリ | 対象 | コスト影響 |
|-----|-----------|------|-----------|
| PDFハイライト | PyMuPDF (fitz) | PDF証跡の引用箇所にハイライト注釈追加 | コンテナ実行時間 +5-15秒/ファイル |
| Excelハイライト | openpyxl | Excelセルの該当箇所を黄色背景 | コンテナ実行時間 +3-10秒/ファイル |
| テキスト→PDFハイライト | reportlab | テキスト/CSV等をPDF化しハイライト | コンテナ実行時間 +5-10秒/ファイル |
| ハイライト済みファイル保存 | azure-data-tables / azure-storage-blob | Blob Storageに一時保存（Table 64KB制限回避） | Blob Storage操作 +2回/ファイル |

> **コスト影響:** 1件あたり約10-25秒の追加実行時間（Container Apps Consumption Plan内）。
> Blob Storageへのハイライト済みファイル保存は一時的（ジョブ取得後は不要）で、容量・操作コストは軽微。

---

## 4. 詳細コスト見積もり

### 4.1 Azure Container Apps

#### 4.1.1 Consumption Plan（従量課金）

| 項目 | 単価 | 無料枠 |
|-----|------|-------|
| vCPU | ¥0.0000342 / vCPU-秒 | 月間18万vCPU-秒 |
| メモリ | ¥0.00000427 / GiB-秒 | 月間36万GiB-秒 |
| リクエスト | ¥0.028 / 100万回 | 月間200万リクエスト |

**計算例:**
```
PoC（1,200件/3ヶ月）:
  リクエスト: 7,200回 → 無料枠内（200万回/月）
  vCPU: 7,200回 × 60秒 × 0.5vCPU = 216,000 vCPU-秒 → 無料枠内（18万vCPU-秒/月）
  PoC合計: ¥0（ほぼ無料枠内）

本番（1,800件/年間）:
  リクエスト: 9,000回/年（月平均750回） → 無料枠内
  vCPU: 9,000回 × 60秒 × 0.5vCPU = 270,000 vCPU-秒/年 → 無料枠内
  年額: ¥0
```

#### 4.1.2 Dedicated Plan（常時稼働）

| 項目 | 月額（東日本リージョン） |
|-----|------------------------|
| vCPU | ¥18,340 / vCPU |
| メモリ | ¥1,306 / GB |
| 1vCPU, 2GB | 約 ¥21,000/月 |

**推奨ケース:** 月10,000項目以上、コールドスタートを回避したい場合

---

### 4.2 Azure AI Foundry（LLMサービス）

#### 4.2.1 GPT-5.2 価格（2026年2月時点・フラッグシップ）

| 項目 | 単価（USD） | 単価（JPY換算@152） |
|-----|-----------|-------------------|
| 入力トークン | $1.75 / 1M tokens | ¥266 / 1M tokens |
| 出力トークン | $14.00 / 1M tokens | ¥2,128 / 1M tokens |

#### 4.2.2 GPT-5-nano 価格（低コスト・推奨）

| 項目 | 単価（USD） | 単価（JPY換算@152） |
|-----|-----------|-------------------|
| 入力トークン | $0.05 / 1M tokens | ¥7.6 / 1M tokens |
| 出力トークン | $0.40 / 1M tokens | ¥61 / 1M tokens |

#### 4.2.3 GPT-5-mini 価格（バランス型）

| 項目 | 単価（USD） | 単価（JPY換算@152） |
|-----|-----------|-------------------|
| 入力トークン | $0.25 / 1M tokens | ¥38 / 1M tokens |
| 出力トークン | $2.00 / 1M tokens | ¥304 / 1M tokens |

#### 4.2.4 トークン消費量の目安（余裕あり）

| 処理フェーズ | 入力トークン | 出力トークン | 備考 |
|-------------|------------|-------------|------|
| テスト計画作成 | 約2,500 | 約700 | 統制情報 + プロンプト |
| 計画レビュー | 約3,500 | 約500 | 計画全文 + レビュー基準 |
| タスク実行（A1-A8） | 約23,000 | 約1,300 | **OCR全文（8p × 2,500t）+ プロンプト** |
| 最終判断 | 約4,000 | 約900 | タスク結果集約 + 評価基準 |
| 判断レビュー | 約2,000 | 約600 | 判断結果 + レビュー基準 |
| **1項目あたり合計** | **約35,000** | **約4,000** | |

> ※ タスク実行にはOCR抽出テキスト（平均8ページ × 約2,500トークン/ページ = 約20,000トークン）を含む
> ※ 日本語文書（規程類・契約書等）は1ページあたり1,500-2,000文字、トークン変換で約2,500トークン/ページ
> ※ 証憑類のテキストは全量がLLM入力トークンとなるため、ページ数に比例して増加します
> ※ 余裕を持った見積もり値（実際の消費はこれより少ない場合があります）

**計算例（GPT-5.2）:**
```
PoC（1,200件/3ヶ月）:
  入力: 35,000 × 1,200 = 42M tokens → ¥266 × 42 = ¥11,172
  出力: 4,000 × 1,200 = 4.8M tokens → ¥2,128 × 4.8 = ¥10,214
  PoC合計: 約 ¥21,400

本番（1,800件/年間）:
  入力: 35,000 × 1,800 = 63M tokens → ¥266 × 63 = ¥16,758
  出力: 4,000 × 1,800 = 7.2M tokens → ¥2,128 × 7.2 = ¥15,322
  年額: 約 ¥32,100
```

---

### 4.3 Azure Document Intelligence

#### 4.3.1 価格表

| モデル | 単価（1,000ページあたり） |
|-------|------------------------|
| Read（テキスト抽出） | ¥228 |
| Layout（レイアウト解析） | ¥1,520 |
| Prebuilt（定型文書） | ¥1,520 |
| Custom（カスタムモデル） | ¥2,280 |

#### 4.3.2 使用量の目安

| 証跡タイプ | 平均ページ数 | 使用モデル |
|-----------|------------|-----------|
| PDF文書 | 2-5ページ | Layout |
| スキャン画像 | 1ページ | Read/Layout |
| Excel/Word | 1-3ページ | Layout |

**計算例（平均8ページ/項目）:**
```
PoC（1,200件/3ヶ月）:
  処理ページ数: 1,200 × 8 = 9,600ページ → ¥1,520 × 9.6 = ¥14,592

本番（1,800件/年間）:
  処理ページ数: 1,800 × 8 = 14,400ページ → ¥1,520 × 14.4 = ¥21,888
```

---

### 4.4 Azure Storage

#### 4.4.1 価格表（Standard LRS、東日本リージョン）

| サービス | 項目 | 単価 |
|---------|-----|------|
| Blob Storage | 容量 | ¥2.8 / GB/月 |
| Blob Storage | 読み取り（10,000回） | ¥0.56 |
| Blob Storage | 書き込み（10,000回） | ¥7.0 |
| Table Storage | 容量 | ¥8.4 / GB/月 |
| Table Storage | トランザクション（10,000回） | ¥0.056 |
| Queue Storage | 容量 | ¥8.4 / GB/月 |
| Queue Storage | トランザクション（10,000回） | ¥0.056 |

**計算例（月1,000項目、非同期モード・ハイライト処理含む）:**
```
Blob(入力証跡):      1GB × ¥2.8 + 2,000回書込 × ¥0.0007 = ¥4.2
Blob(ハイライト済み): 5GB × ¥2.8 + 4,000回操作 × ¥0.0007 = ¥16.8
Table:               0.1GB × ¥8.4 + 10,000回 × ¥0.000056 = ¥1.4
Queue:               0.01GB × ¥8.4 + 5,000回 × ¥0.000056 = ¥0.4
月額: 約 ¥500（最小課金単位による）
```

> **注:** ハイライト済みファイルはBlob Storageに一時保存されます（Table Storageの64KBエンティティ制限回避）。
> クライアントが結果取得後は不要となるため、ライフサイクルポリシーで自動削除可能です。

---

### 4.5 Azure Active Directory

#### 4.5.1 価格表

| プラン | 月額/ユーザー | 機能 |
|-------|-------------|------|
| Free | ¥0 | 基本認証、50,000オブジェクト |
| P1 | 約 ¥912 | 条件付きアクセス、グループ管理 |
| P2 | 約 ¥1,368 | ID保護、特権ID管理 |

**推奨:**
- 開発環境: Free
- 本番環境: P1（条件付きアクセスでセキュリティ強化）

---

### 4.6 監視・ログサービス

#### 4.6.1 Application Insights

| 項目 | 単価 | 無料枠 |
|-----|------|-------|
| データ取り込み | ¥336 / GB | 5GB/月 |
| データ保持（90日超） | ¥16.8 / GB/月 | 90日まで無料 |
| 連続エクスポート | ¥0.056 / GB | - |

#### 4.6.2 Log Analytics Workspace

| 項目 | 単価 | 無料枠 |
|-----|------|-------|
| データ取り込み | ¥336 / GB | 5GB/日（最初の31日） |
| データ保持（90日超） | ¥16.8 / GB/月 | 90日まで無料 |

#### 4.6.3 Azure Monitor

| 項目 | 単価 | 無料枠 |
|-----|------|-------|
| メトリクスアラートルール | ¥15 / ルール/月 | 最初の10ルール無料 |
| ログアラートルール（5分間隔） | ¥75 / ルール/月 | - |
| 通知（Email） | ¥0.28 / 1,000件 | 1,000件/月無料 |

#### 4.6.4 監視コストまとめ

| 規模 | Application Insights | Log Analytics | Azure Monitor | 合計 |
|-----|---------------------|---------------|---------------|------|
| 小規模（100項目） | ¥0（無料枠内） | ¥0（無料枠内） | ¥0（無料枠内） | **¥0** |
| 中規模（1,000項目） | ¥0（無料枠内） | ¥0（無料枠内） | ¥150（オプション） | **¥150** |
| 大規模（10,000項目） | ¥1,680 | ¥5,040 | ¥150 | **¥6,870** |

---

### 4.7 Azure API Management（実装済み）

#### 4.7.1 Consumption Plan（従量課金）

| 項目 | 単価 | 無料枠 |
|-----|------|-------|
| API呼び出し | ¥532 / 100万回 | 最初の100万回/月 |
| セルフホストゲートウェイ | ¥26,000 / ゲートウェイ/月 | - |

**計算例（月1,000項目）:**
```
API呼び出し: 1,000項目 × 5回/件 = 5,000回 → 無料枠内
固定コスト: Consumption Plan最低料金 約 ¥532/月
月額: 約 ¥532
```

**含まれる機能（追加費用なし）:**
- サブスクリプションキー認証
- レート制限（100回/60秒/IP）
- Application Insights連携（100%サンプリング）
- セキュリティヘッダー自動付与
- 相関ID（X-Correlation-ID）プロパゲーション

#### 4.7.2 規模別APIM コスト

| 規模 | 月間API呼び出し | 月額（JPY） |
|-----|----------------|------------|
| 小規模（100項目） | 500回 | ¥532 |
| 中規模（1,000項目） | 5,000回 | ¥532 |
| 大規模（10,000項目） | 50,000回 | ¥532 |

> Consumption Planでは月間100万回まで同一料金のため、規模による差異はほぼありません。

---

### 4.8 Azure Key Vault（実装済み）

| 項目 | 単価 | 備考 |
|-----|------|------|
| シークレット操作 | ¥4.5 / 10,000操作 | 読み取り・書き込み |
| 証明書操作 | ¥450 / 証明書更新 | オプション |
| HSMキー操作 | ¥750 / 10,000操作 | 不使用 |

**計算例:**
```
シークレット数: 5-8個（LLM/OCR/Storage APIキー等）
月間操作: ～500回（Container Apps起動時の読み取り）
月額: 約 ¥50（最小課金単位による）
```

---

## 5. PoC・本番環境 コスト見積もり

> **前提条件:**
> - PoC: 1,200件/3ヶ月（3回スプリント繰り返し + 開発・環境構築分）
> - 本番: 1,800件/年間（実績1,328件 × バッファ1.35倍）
> - 1件あたり: LLM入力35,000トークン、出力4,000トークン、OCR 8ページ
> - 為替レート: 1 USD = ¥152

### 5.1 PoC環境（1,200件/3ヶ月合計）

| リソース | 構成 | 使用量 | PoC合計（JPY） |
|---------|-----|--------|--------------|
| Azure Container Apps | Consumption Plan | 6,000回 | ¥0 |
| Azure AI Foundry (GPT-5.2) | Standard | 入力42M + 出力4.8M tokens | ¥21,400 |
| Document Intelligence | S0 / Layout | 9,600ページ | ¥14,592 |
| Storage（Blob+Table+Queue） | Standard LRS | 3GB + 操作 | ¥300 |
| Key Vault | Standard | 5シークレット | ¥0 |
| Entra ID (Azure AD) | Free | 5ユーザー | ¥0 |
| 監視（AppInsights+Monitor） | 無料枠内 | 2GB/月 × 3ヶ月 | ¥0 |
| **PoC合計（3ヶ月）** | | | **¥36,292** |

### 5.2 本番環境（1,800件/年間）

| リソース | 構成 | 年間使用量 | 年額（JPY） |
|---------|-----|-----------|------------|
| Azure Container Apps | Consumption Plan | 9,000回/年 | ¥0 |
| Azure AI Foundry (GPT-5.2) | Standard | 入力63M + 出力7.2M tokens | ¥32,080 |
| Document Intelligence | S0 / Layout | 14,400ページ | ¥21,888 |
| Storage（Blob+Table+Queue） | Standard LRS | 3.5GB + 操作 | ¥1,500 |
| APIM | Consumption | 9,000回/年 | ¥6,384 |
| Key Vault | Standard | 8シークレット | ¥600 |
| Entra ID (Azure AD) | P1 | 5ユーザー × 12ヶ月 | ¥54,720 |
| 監視（AppInsights+Monitor） | Basic + アラート | 5ルール × 12ヶ月 | ¥1,824 |
| **本番合計（年間）** | | | **¥118,996** |

> **注:** Entra ID を Free プランにする場合、年額は **¥64,276** まで低下します。

### 5.3 コスト削減オプション

| オプション | 削減効果 | 適用条件 |
|-----------|---------|---------|
| GPT-5-nano使用 | LLMコスト約97%削減（年間LLM: ¥502） | 精度許容範囲内 |
| GPT-5-mini使用 | LLMコスト約86%削減（年間LLM: ¥4,582） | バランス重視 |
| セルフリフレクション無効化 | LLMコスト約40%削減 | 品質許容範囲内 |
| OCRスキップ（テキストPDF） | OCRコスト約30%削減 | テキスト抽出可能なPDF |

---

## 6. 初期構築費用

### 6.1 リソースプロビジョニング

| 項目 | 作業時間目安 | 備考 |
|-----|------------|------|
| Azure サブスクリプション設定 | 1時間 | 既存サブスクリプション利用可 |
| リソースグループ作成 | 0.5時間 | |
| Azure Container Apps デプロイ | 2時間 | Docker + Terraform テンプレート利用可 |
| Azure AI Foundry 設定 | 1-2時間 | Model Catalogからデプロイ |
| Document Intelligence 設定 | 1時間 | |
| Storage Account 設定 | 0.5時間 | |
| Azure AD 設定（オプション） | 2時間 | App Registration含む |
| **合計** | **約1営業日** | |

---

## 7. SLA（サービスレベル）

| サービス | SLA |
|---------|-----|
| Azure Container Apps (Consumption) | 99.95% |
| Azure Container Apps (Dedicated) | 99.95% |
| Azure AI Foundry | 99.9% |
| Azure Document Intelligence | 99.9% |
| Azure Storage | 99.9% (LRS) |
| Azure AD | 99.99% |

**複合SLA:** 99.95% × 99.9% × 99.9% × 99.9% = 99.65%（月間ダウンタイム最大約2.5時間）

---

## 8. リージョン選択

| リージョン | 理由 | 注意点 |
|-----------|------|-------|
| **東日本（Japan East）** | 低レイテンシ、データ主権 | Azure AI Foundry 利用可 |
| 西日本（Japan West） | DR用途 | 一部サービス制限 |

---

## 付録A: 環境変数設定例

```env
# LLM Provider
LLM_PROVIDER=AZURE_FOUNDRY
AZURE_FOUNDRY_ENDPOINT=https://your-project.japaneast.models.ai.azure.com
AZURE_FOUNDRY_API_KEY=your-api-key
AZURE_FOUNDRY_MODEL=gpt-5.2

# OCR Provider
OCR_PROVIDER=AZURE
AZURE_DI_ENDPOINT=https://your-di.cognitiveservices.azure.com/
AZURE_DI_KEY=your-di-key

# Storage (非同期モード)
JOB_STORAGE_PROVIDER=AZURE
JOB_QUEUE_PROVIDER=AZURE
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;...

# Performance Tuning
MAX_PLAN_REVISIONS=1
MAX_JUDGMENT_REVISIONS=1
```

## 付録B: 参考リンク

- [Azure Container Apps 価格](https://azure.microsoft.com/ja-jp/pricing/details/container-apps/)
- [Azure AI Foundry 価格](https://azure.microsoft.com/ja-jp/pricing/details/cognitive-services/openai-service/)
- [Azure Document Intelligence 価格](https://azure.microsoft.com/ja-jp/pricing/details/ai-document-intelligence/)
- [Azure Storage 価格](https://azure.microsoft.com/ja-jp/pricing/details/storage/)

---

# Part 2: GCP (Google Cloud Platform)

## 1. GCPリソース概要

### 1.1 必須リソース

| リソース | GCP サービス名 | 用途 |
|---------|---------------|------|
| APIホスティング | Cloud Run | REST API エンドポイント（Docker + FastAPI） |
| LLM処理 | Vertex AI (Gemini 3) | AI評価 |
| OCR処理 | Document AI | PDF・画像からのテキスト抽出 |
| ファイル保存 | Cloud Storage | 一時ファイル、ログ |

### 1.2 非同期モード追加リソース

| リソース | GCP サービス名 | 用途 |
|---------|---------------|------|
| ジョブ状態管理 | Firestore | ジョブID、ステータス、結果保存 |
| ジョブキュー | Cloud Tasks | 処理待ちジョブの管理 |

## 2. GCPコスト概算

### 2.1 Cloud Run

| 項目 | 単価 | 無料枠 |
|-----|------|-------|
| vCPU | $0.00002400 / vCPU-秒 | 月間18万vCPU-秒 |
| メモリ | $0.00000250 / GiB-秒 | 月間36万GiB-秒 |
| リクエスト | $0.40 / 100万回 | 200万回/月 |

### 2.2 Vertex AI (Gemini 3 Pro Preview)

| 項目 | 単価（USD） | 単価（JPY換算@152） |
|-----|-----------|-------------------|
| 入力トークン | $2.00 / 1M tokens | ¥304 / 1M tokens |
| 出力トークン | $12.00 / 1M tokens | ¥1,824 / 1M tokens |

> **低コスト版:** Gemini 3 Flash Preview: 入力 $0.50/1M, 出力 $3.00/1M（約75%削減）
> **GA安定版:** Gemini 2.5 Pro: 入力 $1.25/1M, 出力 $10.00/1M
> **超低コスト版:** Gemini 2.5 Flash: 入力 $0.15/1M, 出力 $0.60/1M（約94%削減）
> ※ Gemini 3.x は **globalリージョン必須**

### 2.3 Document AI

| モデル | 単価（1,000ページあたり） |
|-------|------------------------|
| Document OCR | $1.50 |
| Form Parser | $30.00 |
| Layout Parser | $10.00 |

### 2.4 規模別概算

| 規模 | 月額（USD） | 月額（JPY換算@152） |
|-----|-----------|-------------------|
| 小規模（100項目） | $22 | ¥3,344 |
| 中規模（1,000項目） | $203 | ¥30,856 |
| 大規模（10,000項目） | $2,020 | ¥307,040 |

## 3. GCP参考リンク

- [Cloud Run 価格](https://cloud.google.com/run/pricing)
- [Vertex AI 価格](https://cloud.google.com/vertex-ai/pricing)
- [Document AI 価格](https://cloud.google.com/document-ai/pricing)
- [Cloud Storage 価格](https://cloud.google.com/storage/pricing)
- [Firestore 価格](https://cloud.google.com/firestore/pricing)

---

# Part 3: AWS (Amazon Web Services)

## 1. AWSリソース概要

### 1.1 必須リソース

| リソース | AWS サービス名 | 用途 |
|---------|---------------|------|
| APIホスティング | App Runner | REST API エンドポイント（Docker + FastAPI） |
| LLM処理 | Amazon Bedrock (Claude Opus 4.6) | AI評価 |
| OCR処理（英語） | Amazon Textract | PDF・画像からのテキスト抽出 |
| OCR処理（日本語） | YomiToku-Pro (SageMaker) | 日本語特化高精度OCR |
| OCR処理（タイ/蘭語） | Tesseract (Lambda Docker) | 多言語OCR |
| ファイル保存 | S3 | 一時ファイル、ログ |

### 1.2 非同期モード追加リソース

| リソース | AWS サービス名 | 用途 |
|---------|---------------|------|
| ジョブ状態管理 | DynamoDB | ジョブID、ステータス、結果保存 |
| ジョブキュー | SQS | 処理待ちジョブの管理 |

### 1.3 OCR構成（3プロバイダー）

AWSではTextractが日本語・タイ語・オランダ語に非対応のため、言語別にOCRを分割します。

| 言語 | OCRプロバイダー | サービス | 特徴 |
|-----|---------------|---------|------|
| **日本語** (70%) | YomiToku-Pro | SageMaker Endpoint (AWS Marketplace) | 手書き・複雑レイアウト対応 |
| **タイ語・オランダ語** (5%) | Tesseract | Lambda Docker (言語パック含む) | OSS、低コスト |
| **英語・その他** (25%) | Amazon Textract | AnalyzeDocument API | AWS標準、高精度 |

## 2. AWSコスト概算

### 2.1 App Runner

| 項目 | 単価 | 無料枠 |
|-----|------|-------|
| vCPU（アクティブ） | $0.064 / vCPU-時間 | - |
| メモリ（アクティブ） | $0.007 / GB-時間 | - |
| 自動一時停止時のプロビジョニング | $0.007 / GB-時間 | - |

### 2.2 Amazon Bedrock (Claude Opus 4.6)

| 項目 | 単価（USD） | 単価（JPY換算@152） |
|-----|-----------|-------------------|
| 入力トークン | $5.00 / 1M tokens | ¥760 / 1M tokens |
| 出力トークン | $25.00 / 1M tokens | ¥3,800 / 1M tokens |

> **バランス型:** Claude Sonnet 4.5: 入力 $3.00/1M, 出力 $15.00/1M（約40%削減）
> **低コスト版:** Claude Haiku 4.5: 入力 $1.00/1M, 出力 $5.00/1M（約80%削減）

### 2.3 Amazon Textract

| API | 単価（1,000ページあたり） |
|-----|------------------------|
| Detect Document Text | $1.50 |
| Analyze Document | $15.00 |
| Analyze Expense | $10.00 |

### 2.4 YomiToku-Pro (SageMaker Endpoint)

| 項目 | 費用 | 備考 |
|-----|------|------|
| SageMaker Endpoint (ml.g4dn.xlarge) | $379/月 | GPU推論インスタンス（24時間稼働時） |
| AWS Marketplace ライセンス | $150/月 | YomiToku-Proソフトウェア利用料 |
| **合計（常時稼働）** | **$529/月** | |
| **合計（繁忙期2ヶ月のみ）** | **$1,058/年** | 閑散期は停止 |

> **SageMaker Serverless Inference** を使用すると処理時のみ課金となり、
> 年間コストを約60-70%削減可能（ただしコールドスタートあり）。

### 2.5 規模別概算

| 規模 | 月額（USD） | 月額（JPY換算@152） |
|-----|-----------|-------------------|
| 小規模（100項目） | $42 | ¥6,384 |
| 中規模（1,000項目） | $400 | ¥60,800 |
| 大規模（10,000項目） | $3,990 | ¥606,480 |

> ※ YomiToku-Pro(SageMaker)の固定費を含まない。含む場合は+$529/月

## 3. AWS参考リンク

- [App Runner 価格](https://aws.amazon.com/apprunner/pricing/)
- [Amazon Bedrock 価格](https://aws.amazon.com/bedrock/pricing/)
- [Amazon Textract 価格](https://aws.amazon.com/textract/pricing/)
- [SageMaker 価格](https://aws.amazon.com/sagemaker/pricing/)
- [S3 価格](https://aws.amazon.com/s3/pricing/)
- [DynamoDB 価格](https://aws.amazon.com/dynamodb/pricing/)

---

# Part 4: プラットフォーム比較

## 1. 機能比較

| 機能 | Azure | GCP | AWS |
|-----|-------|-----|-----|
| コンテナホスティング | Azure Container Apps | Cloud Run | App Runner |
| LLM | AI Foundry (GPT-5.2) | Vertex AI (Gemini 3 Pro) | Bedrock (Claude Opus 4.6) |
| OCR | Document Intelligence | Document AI | Textract + YomiToku + Tesseract |
| ジョブストレージ | Table Storage | Firestore | DynamoDB |
| ジョブキュー | Queue Storage | Cloud Tasks | SQS |
| OCR言語対応 | 全言語一元 | 全言語一元 | 3プロバイダー分割 |

## 2. コスト比較（中規模：月1,000項目）

| 項目 | Azure | GCP | AWS |
|-----|-------|-----|-----|
| コンテナホスティング | ¥0 | ¥0（無料枠） | ¥0（無料枠） |
| LLM | ¥17,830 | ¥17,920 | ¥41,800 |
| OCR | ¥12,160 | ¥12,160 | ¥18,240 |
| ストレージ | ¥500 | ¥304 | ¥304 |
| **合計** | **¥30,490** | **¥30,384** | **¥60,344** |

※ AWS はYomiToku-Pro(SageMaker)の固定費を含まない
※ LLMモデル・使用量により大きく変動します

## 3. 選択ガイド

| シナリオ | 推奨プラットフォーム | 理由 |
|---------|-------------------|------|
| Microsoft環境統合 | Azure | Azure AD、M365との連携 |
| コスト重視 | GCP | Gemini 3 Flashの低価格 |
| 最高精度（LLM + 日本語OCR） | AWS | Claude Opus 4.6 + YomiToku-Pro |
| 既存インフラ活用 | 既存クラウド | 運用ノウハウ活用 |

---

---

# Part 5: PoC・本番環境 詳細見積もり（精緻版）

> **為替レート前提:** 1 USD = ¥152（見積もり全体で統一）
> **バッファ:** 全処理量に30%の余裕を加算済み（余裕を持った見積もり）
> **実績データ:** 本番運用時のファイル数・サイズを反映（1,328ファイル / 3.2GB）

---

## 1. 前提条件

### 1.1 データ量定義（実績ベース・余裕あり）

| フェーズ | 統制数 | サンプル数/統制 | テスト件数 | 期間 | 備考 |
|---------|-------|----------------|-----------|------|------|
| **PoC基本処理** | 35 | 平均3 | 110 | 2-3ヶ月 | 35統制の初期検証 |
| **3回スプリント繰り返し** | - | - | 110 × 3回 = 330 | - | 検証・改善サイクル |
| **開発・環境構築** | - | - | +200-500 | PoC前1ヶ月 | 環境構築・チューニング・再実行 |
| **PoC実処理合計** | | | **530-830** | | 基本330件 + 開発分 |
| **PoC合計（バッファ含・予算取り用）** | | | **1,000-1,200** | **2-3ヶ月** | 実処理×1.3-1.5倍の余裕 |
| **本番（年間・実績）** | 35 | ~38 | **1,328** | **年1回** | **実測値: 1,328ファイル / 3.2GB** |
| **本番（バッファ含・予算取り用）** | | | **1,800** | **年間** | 1,328 × 約1.35倍（余裕あり） |

> **重要:** 本番テスト件数は**年間**の処理量です（月間ではありません）。
> 内部統制テストは期末監査等で年1回実施され、繁忙期（2-3ヶ月）に集中処理されます。
> **実績:** 全1,328ファイル（3.2GB）は実際の本番運用データに基づく値です。

### 1.2 エビデンス（証跡）の特性

| エビデンス種別 | 割合 | 平均ページ数 | ファイルサイズ | 特徴 |
|--------------|------|------------|-------------|------|
| 契約書・覚書 | 25% | 10-30ページ | 2-10MB | スキャン画像多、押印・署名あり |
| 社内規程・マニュアル | 20% | 5-20ページ | 1-5MB | テキストPDF + 画像混在 |
| 承認記録・稟議書 | 20% | 2-5ページ | 0.5-2MB | スキャン画像が主 |
| システムログ・画面キャプチャ | 15% | 1-3ページ | 0.2-1MB | スクリーンショット |
| Excel帳票・報告書 | 15% | 1-5ページ | 0.1-2MB | テキスト抽出可能 |
| その他（議事録等） | 5% | 2-10ページ | 0.5-3MB | 混在形式 |
| **加重平均** | **100%** | **約8ページ** | **約2.4MB** | **実測: 3.2GB / 1,328件** |

> ※ ページ数は余裕を持って8ページで見積もり（実測サイズから推定6-7ページ）

### 1.3 処理パラメータ（余裕を持った見積もり）

| パラメータ | 値 | 算出根拠 |
|-----------|-----|---------|
| 1件あたりOCRページ数 | **8ページ** | エビデンス加重平均（余裕あり） |
| 1件あたりLLM入力トークン | **35,000** | プロンプト+統制情報 15,000 + OCR抽出テキスト 20,000 |
| 1件あたりLLM出力トークン | **4,000** | 計画+レビュー+タスク実行+判断+判断レビュー（余裕あり） |
| 1件あたりファイルサイズ | **2.4MB** | **実測: 3.2GB / 1,328件** |
| セルフリフレクション | 有効 | MAX_REVISIONS=1（品質重視） |
| バッファ係数 | **×1.3** | 再実行・エラーリトライ・追加テスト考慮（余裕あり） |

**LLMトークン内訳（1件あたり・余裕あり）:**

| 処理フェーズ | 入力トークン | 出力トークン | 備考 |
|-------------|------------|-------------|------|
| テスト計画作成 | 2,500 | 700 | プロンプト + 統制情報 |
| 計画レビュー | 3,500 | 500 | 計画全文 + レビュー基準 |
| タスク実行（A1-A8） | 23,000 | 1,300 | **OCR全文（8p × 2,500t）+ プロンプト** |
| 最終判断 | 4,000 | 900 | タスク結果集約 + 評価基準 |
| 判断レビュー | 2,000 | 600 | 判断結果 + レビュー基準 |
| **1件合計** | **35,000** | **4,000** | |

### 1.4 処理量サマリー（バッファ30%加算済み）

| 項目 | PoC（1,200件） | 本番・年間（1,800件） |
|-----|--------------|---------------------|
| **合計処理件数** | 1,200件 | 1,800件 |
| **OCRページ数** | 9,600ページ | 14,400ページ |
| **LLM入力トークン** | 42M tokens | 63M tokens |
| **LLM出力トークン** | 4.8M tokens | 7.2M tokens |
| **ファイルストレージ** | 3GB（ピーク） | 3.2GB（累計）/3.5GB（ピーク） |
| **API呼び出し回数** | 6,000回（5回/件） | 9,000回（5回/件） |

### 1.5 OCR言語別振り分け（AWSのみ該当）

| 言語 | OCRプロバイダー | 割合 | PoC(9,600p) | 本番(14,400p) |
|-----|---------------|------|------------|--------------|
| 日本語 | YomiToku-Pro (SageMaker) | 70% | 6,720ページ | 10,080ページ |
| タイ語/オランダ語 | Tesseract (Lambda Docker) | 5% | 480ページ | 720ページ |
| 英語/その他 | Amazon Textract | 25% | 2,400ページ | 3,600ページ |

> **Azure / GCP:** Document Intelligence / Document AI が日本語・英語・タイ語・オランダ語を
> ネイティブ対応するため、単一OCRサービスで全言語を処理可能です。

---

## 2. PoC環境見積もり（全期間合計：2-3ヶ月分）

### 2.1 Azure PoC 詳細明細

| # | カテゴリ | リソース名 | プラン/SKU | 設定 | 使用量 | 費用（JPY） |
|---|---------|-----------|-----------|------|--------|------------|
| 1 | コンピュート | Azure Container Apps | **Consumption Plan** | vCPU 0.5, メモリ1GB, Docker+FastAPI | 6,000回 × 60秒 | ¥0 |
| 2 | LLM | Azure AI Foundry | **Standard** | GPT-5.2, East Japan | 入力42M tokens | ¥11,172 |
| 3 | LLM | Azure AI Foundry | Standard | GPT-5.2, East Japan | 出力4.8M tokens | ¥10,214 |
| 4 | OCR | Document Intelligence | **S0 / Layout** | East Japan, 全言語対応 | 9,600ページ | ¥14,592 |
| 5 | ストレージ | Blob Storage | **Standard LRS Hot** | エビデンス一時保存 | 3GB + 12,000操作 | ¥150 |
| 6 | ストレージ | Table Storage | **Standard LRS** | ジョブ状態管理 | 0.2GB + 15,000操作 | ¥100 |
| 7 | ストレージ | Queue Storage | **Standard LRS** | 非同期ジョブキュー | 0.05GB + 12,000操作 | ¥50 |
| 8 | 監視 | Application Insights | **Basic** | ログ・トレース・例外 | 2GB/月 × 2-3ヶ月 | ¥0 |
| 9 | 監視 | Log Analytics Workspace | **従量課金** | 診断ログ集約, 保持90日 | 1GB/月 × 2-3ヶ月 | ¥0 |
| 10 | 監視 | Azure Monitor | **メトリクスアラート** | エラー率/応答時間/API障害 | 3ルール × 2-3ヶ月 | ¥0 |
| 11 | セキュリティ | Key Vault | **Standard** | APIキー・接続文字列保管 | 5シークレット | ¥0 |
| 12 | 認証 | Entra ID (Azure AD) | **Free** | 基本認証（PoC用） | 5ユーザー | ¥0 |
| | | | | | | |
| | **Azure PoC 合計** | | | | | **¥36,278** |

### 2.2 GCP PoC 詳細明細

| # | カテゴリ | リソース名 | プラン | 設定 | 使用量 | USD | JPY(@152) |
|---|---------|-----------|-------|------|--------|-----|-----------|
| 1 | コンピュート | Cloud Run | **従量課金** | vCPU 1, メモリ1GB, Docker+FastAPI | 6,000回 | $0 | ¥0 |
| 2 | LLM | Vertex AI | **Gemini 3 Pro Preview** | global | 入力42M tokens | $84 | ¥12,768 |
| 3 | LLM | Vertex AI | Gemini 3 Pro Preview | global | 出力4.8M tokens | $57.6 | ¥8,755 |
| 4 | OCR | Document AI | **Layout Parser** | 全言語対応 | 9,600ページ | $96 | ¥14,592 |
| 5 | ストレージ | Cloud Storage | **Standard** | asia-northeast1 | 3GB | $0.08 | ¥12 |
| 6 | DB | Firestore | **Native mode** | ジョブ管理 | 6,000ドキュメント | $2 | ¥304 |
| 7 | キュー | Cloud Tasks | **従量課金** | 非同期ジョブ | 6,000タスク | $0 | ¥0 |
| 8 | 監視 | Cloud Logging | **従量課金** | ログ収集 | 2GB/月 × 2-3ヶ月 | $0 | ¥0 |
| 9 | 監視 | Cloud Monitoring | **従量課金** | メトリクス・アラート | 基本 | $0 | ¥0 |
| 10 | セキュリティ | Secret Manager | **従量課金** | API キー保管 | 5シークレット | $0.15 | ¥23 |
| 11 | 認証 | IAM | **標準** | サービスアカウント | 3アカウント | $0 | ¥0 |
| | | | | | | | |
| | **GCP PoC 合計** | | | | | **$240** | **¥36,454** |

### 2.3 AWS PoC 詳細明細

| # | カテゴリ | リソース名 | プラン | 設定 | 使用量 | USD | JPY(@152) |
|---|---------|-----------|-------|------|--------|-----|-----------|
| 1 | コンピュート | App Runner | **従量課金** | vCPU 1, メモリ2GB, Docker+FastAPI | 6,000回 | $0 | ¥0 |
| 2 | API | API Gateway | **REST API** | リージョンエンドポイント | 6,000回 | $0 | ¥0 |
| 3 | LLM | Amazon Bedrock | **Claude Opus 4.6** | ap-northeast-1 | 入力42M tokens | $210 | ¥31,920 |
| 4 | LLM | Amazon Bedrock | Claude Opus 4.6 | ap-northeast-1 | 出力4.8M tokens | $120 | ¥18,240 |
| 5 | OCR(日本語) | SageMaker Endpoint | **ml.g4dn.xlarge** | YomiToku-Pro推論 | 2ヶ月稼働(24h) | $758 | ¥115,216 |
| 6 | OCR(日本語) | AWS Marketplace | **YomiToku-Pro** | ソフトウェア利用料 | 2ヶ月 | $300 | ¥45,600 |
| 7 | OCR(タイ/蘭) | Lambda Docker | **Tesseract OCR** | メモリ1GB, jpn+tha+nld+eng | 480ページ | $1 | ¥152 |
| 8 | OCR(英語等) | Amazon Textract | **AnalyzeDocument** | テーブル・フォーム解析 | 2,400ページ | $36 | ¥5,472 |
| 9 | コンテナ | ECR | **Standard** | Tesseract Dockerイメージ | 1GB | $0.10 | ¥15 |
| 10 | ストレージ | S3 | **Standard** | エビデンス一時保存 | 3GB | $0.07 | ¥11 |
| 11 | DB | DynamoDB | **オンデマンド** | ジョブ状態管理 | 6,000 RWU | $2 | ¥304 |
| 12 | キュー | SQS | **Standard** | 非同期ジョブ | 6,000メッセージ | $0 | ¥0 |
| 13 | セキュリティ | Secrets Manager | **Standard** | APIキー保管 | 5シークレット × 2-3ヶ月 | $3 | ¥456 |
| 14 | 監視 | CloudWatch | **Standard** | ログ・メトリクス | 2GB/月 × 2-3ヶ月 | $5 | ¥760 |
| 15 | 監視 | CloudWatch Alarms | **Standard** | エラー率・レイテンシ | 5アラーム × 2-3ヶ月 | $2 | ¥304 |
| 16 | 認証 | IAM | **標準** | ロール・ポリシー | - | $0 | ¥0 |
| | | | | | | | |
| | **AWS PoC 合計** | | | | | **$1,437** | **¥218,450** |

> **AWS注記:** SageMaker(YomiToku-Pro)のコストが約83%を占めます。
> SageMaker Serverless Inferenceを使用する場合、処理時のみ課金となり
> OCR日本語コストを約60-70%削減可能です（ただしコールドスタートあり）。

### 2.4 PoC見積もりサマリー

| プラットフォーム | PoC全期間合計（JPY） | 月平均（2-3ヶ月換算） | 特徴 |
|----------------|--------------------|--------------------|------|
| **Azure** | **¥36,278** | ¥12,100-18,100 | OCR一元管理、バランス型 |
| **GCP** | **¥36,454** | ¥12,200-18,200 | Gemini 3 Pro + Document AI |
| **AWS** | **¥218,450** | ¥72,800-109,200 | 最高精度、SageMaker OCR含む |

---

## 3. 本番環境見積もり（年間1,328件 → バッファ含1,800件）

### 3.1 本番処理の時期的特性

| 想定パターン | 月数 | 月間処理件数 | 小計 | 備考 |
|-------------|------|-------------|------|------|
| **繁忙期** | 2ヶ月（2-3月） | 400-500件/月 | ~900件 | 期末監査集中処理 |
| **通常期** | 4ヶ月（4-5月, 10-12月） | 50-100件/月 | ~320件 | 追加テスト・再テスト |
| **閑散期** | 6ヶ月（6-9月, 1月） | 0-20件/月 | ~108件 | メンテナンスのみ |
| **年間合計** | 12ヶ月 | | **1,328件** | **実績データ** |

> 1,328件/年のデータ量では、Consumption Plan（従量課金）で十分対応可能です。

### 3.2 Azure 本番 年間詳細明細

| # | カテゴリ | リソース名 | プラン/SKU | 設定詳細 | 年間使用量 | 年額（JPY） |
|---|---------|-----------|-----------|---------|-----------|------------|
| | **--- コンピュート ---** | | | | | |
| 1 | コンピュート | Azure Functions | **Consumption Plan** | 512MB, 230秒, East Japan | 9,000回/年 | ¥0 |
| | **--- AI/LLM ---** | | | | | |
| 2 | LLM(入力) | Azure AI Foundry | **Standard** | GPT-5.2, East Japan | 63M tokens | ¥16,758 |
| 3 | LLM(出力) | Azure AI Foundry | Standard | GPT-5.2, East Japan | 7.2M tokens | ¥15,322 |
| | **--- OCR ---** | | | | | |
| 4 | OCR | Document Intelligence | **S0 / Layout** | 全言語ネイティブ対応(日/英/タイ/蘭) | 14,400ページ | ¥21,888 |
| | **--- ストレージ ---** | | | | | |
| 5 | Blob Storage | Storage Account | **Standard LRS Hot** | エビデンス一時保存, 30日自動削除 | 3.5GB(ピーク) + 18K操作 | ¥700 |
| 6 | Table Storage | Storage Account | **Standard LRS** | ジョブ状態・評価結果保持 | 0.5GB + 36K操作 | ¥500 |
| 7 | Queue Storage | Storage Account | **Standard LRS** | 非同期ジョブキュー | 0.1GB + 18K操作 | ¥300 |
| | **--- API管理 ---** | | | | | |
| 8 | API Gateway | Azure API Management | **Consumption** | レート制限/認証/ログ | 9,000回/年（無料枠内） | ¥6,384 |
| | **--- 認証・セキュリティ ---** | | | | | |
| 9 | 認証 | Entra ID (Azure AD) | **P1** | 条件付きアクセス, MFA | 5ユーザー × 12ヶ月 | ¥54,720 |
| 10 | シークレット | Key Vault | **Standard** | APIキー・接続文字列 | 8シークレット + 5K操作 | ¥600 |
| | **--- 監視・ログ ---** | | | | | |
| 11 | APM | Application Insights | **Basic** | トレース・例外・依存関係 | 年間3GB（無料枠内） | ¥0 |
| 12 | ログ | Log Analytics Workspace | **従量課金** | 診断ログ集約, 保持90日 | 年間4GB（無料枠内） | ¥0 |
| 13 | アラート | Azure Monitor | **メトリクス3 + ログ2** | エラー率/応答/API + 日次レポート | 5ルール × 12ヶ月 | ¥1,824 |
| 14 | 診断設定 | Diagnostic Settings | **-** | Functions/Foundry/DI → Log Analytics | 3設定 | ¥0 |
| | | | | | | |
| | **Azure 本番 年間合計** | | | | | **¥118,996** |

### 3.3 GCP 本番 年間詳細明細

| # | カテゴリ | リソース名 | プラン | 設定詳細 | 年間使用量 | USD | 年額JPY(@152) |
|---|---------|-----------|-------|---------|-----------|-----|-------------|
| | **--- コンピュート ---** | | | | | | |
| 1 | コンピュート | Cloud Functions (2nd gen) | **従量課金** | メモリ1GB, 最小0インスタンス | 9,000回 + 計算時間 | $18 | ¥2,736 |
| | **--- AI/LLM ---** | | | | | | |
| 2 | LLM(入力) | Vertex AI | **Gemini 3 Pro Preview** | global | 63M tokens | $126 | ¥19,152 |
| 3 | LLM(出力) | Vertex AI | Gemini 3 Pro Preview | global | 7.2M tokens | $86.4 | ¥13,133 |
| | **--- OCR ---** | | | | | | |
| 4 | OCR | Document AI | **Layout Parser** | 全言語ネイティブ対応 | 14,400ページ | $144 | ¥21,888 |
| | **--- ストレージ ---** | | | | | | |
| 5 | ファイル | Cloud Storage | **Standard** | asia-northeast1, 30日ライフサイクル | 3.5GB(ピーク) | $5 | ¥760 |
| 6 | DB | Firestore | **Native mode** | ジョブ管理・評価結果 | 18Kドキュメント | $10 | ¥1,520 |
| 7 | キュー | Cloud Tasks | **従量課金** | 非同期ジョブ | 9,000タスク | $2 | ¥304 |
| | **--- 認証・セキュリティ ---** | | | | | | |
| 8 | 認証 | IAM | **標準** | サービスアカウント | 5アカウント | $0 | ¥0 |
| 9 | シークレット | Secret Manager | **従量課金** | APIキー保管 | 8シークレット × 12ヶ月 | $5 | ¥760 |
| | **--- 監視・ログ ---** | | | | | | |
| 10 | ログ | Cloud Logging | **従量課金** | 全サービスログ集約 | 年間4GB（無料枠内） | $0 | ¥0 |
| 11 | 監視 | Cloud Monitoring | **従量課金** | メトリクス・アラート | 年間 | $15 | ¥2,280 |
| 12 | トレース | Cloud Trace | **従量課金** | リクエストトレース | 年間 | $3 | ¥456 |
| | | | | | | | |
| | **GCP 本番 年間合計** | | | | | **$414** | **¥62,989** |

### 3.4 AWS 本番 年間詳細明細

| # | カテゴリ | リソース名 | プラン | 設定詳細 | 年間使用量 | USD | 年額JPY(@152) |
|---|---------|-----------|-------|---------|-----------|-----|-------------|
| | **--- コンピュート ---** | | | | | | |
| 1 | コンピュート | Lambda | **従量課金** | メモリ512MB, タイムアウト300秒 | 9,000回 | $4 | ¥608 |
| 2 | API | API Gateway | **REST API** | リージョンエンドポイント, WAF付き | 9,000回 | $1 | ¥152 |
| | **--- AI/LLM ---** | | | | | | |
| 3 | LLM(入力) | Amazon Bedrock | **Claude Opus 4.6** | ap-northeast-1 | 63M tokens | $315 | ¥47,880 |
| 4 | LLM(出力) | Amazon Bedrock | Claude Opus 4.6 | ap-northeast-1 | 7.2M tokens | $180 | ¥27,360 |
| | **--- OCR（3プロバイダー構成）---** | | | | | | |
| 5 | OCR(日本語) | SageMaker Endpoint | **ml.g4dn.xlarge** | YomiToku-Pro推論エンドポイント | **2ヶ月稼働**(繁忙期) | $758 | ¥115,216 |
| 6 | OCR(日本語) | AWS Marketplace | **YomiToku-Pro** | ソフトウェアライセンス | 2ヶ月 | $300 | ¥45,600 |
| 7 | OCR(タイ/蘭) | Lambda Docker | **Tesseract OCR** | 1GB, jpn+tha+nld+eng lang pack | 720ページ | $2 | ¥304 |
| 8 | OCR(英語等) | Amazon Textract | **AnalyzeDocument** | テーブル・フォーム解析 | 3,600ページ | $54 | ¥8,208 |
| 9 | コンテナ | ECR | **Standard** | Tesseract Dockerイメージ保管 | 1GB × 12ヶ月 | $1 | ¥152 |
| | **--- ストレージ ---** | | | | | | |
| 10 | ファイル | S3 | **Standard** | エビデンス一時保存, 30日ライフサイクル | 3.5GB(ピーク) | $5 | ¥760 |
| 11 | DB | DynamoDB | **オンデマンド** | ジョブ状態・評価結果 | 18K RWU | $6 | ¥912 |
| 12 | キュー | SQS | **Standard** | 非同期ジョブ | 9,000メッセージ | $0 | ¥0 |
| | **--- 認証・セキュリティ ---** | | | | | | |
| 13 | シークレット | Secrets Manager | **Standard** | APIキー・接続文字列 | 8シークレット × 12ヶ月 | $38 | ¥5,776 |
| 14 | 認証 | IAM | **標準** | ロール・ポリシー | - | $0 | ¥0 |
| | **--- 監視・ログ ---** | | | | | | |
| 15 | ログ | CloudWatch Logs | **Standard** | 全サービスログ集約 | 年間4GB | $4 | ¥608 |
| 16 | メトリクス | CloudWatch Metrics | **Standard** | カスタムメトリクス含む | 12ヶ月 | $12 | ¥1,824 |
| 17 | アラーム | CloudWatch Alarms | **Standard** | エラー率/レイテンシ/コスト | 5アラーム × 12ヶ月 | $6 | ¥912 |
| 18 | トレース | X-Ray | **従量課金** | リクエストトレース | 年間 | $4 | ¥608 |
| | | | | | | | |
| | **AWS 本番 年間合計** | | | | | **$1,690** | **¥256,880** |

> **AWS SageMaker最適化オプション:**
> - SageMaker Serverless Inference使用時: OCR日本語コスト ¥158,700 → 約¥50,000（-68%）
> - 閑散期のエンドポイント停止スケジュール設定で更に削減可能
> - スポットインスタンス（ml.g4dn.xlarge）使用で最大60%削減

### 3.5 本番見積もり比較サマリー

| プラットフォーム | 年間合計（JPY） | うちLLM | うちOCR | うちインフラ | 特徴 |
|----------------|---------------|--------|--------|------------|------|
| **Azure** | **¥118,996** | ¥32,080 | ¥21,888 | ¥65,028 | OCR一元管理, APIM含む |
| **GCP** | **¥62,989** | ¥32,285 | ¥21,888 | ¥8,816 | Gemini 3 Pro, 軽量インフラ |
| **AWS** | **¥256,880** | ¥75,240 | ¥169,480 | ¥12,160 | 最高精度LLM, SageMaker OCR |

**コスト構成比（本番年間）:**

```
Azure:  LLM 27% | OCR 18% | インフラ 55%  ← Entra ID P1(¥54,720)+APIM(¥6,384)が支配的
GCP:    LLM 51% | OCR 35% | インフラ 14%  ← LLMがコスト中心
AWS:    LLM 29% | OCR 66% | インフラ  5%  ← SageMaker OCRが圧倒的
```

> **注:** Azure のインフラ比率が高いのは Entra ID P1（¥54,720/年）+ APIM（¥6,384/年）によるものです。
> Free プランの場合、Azure 年間合計は **¥64,276** まで低下します。

---

## 4. 総合コスト見積もり

### 4.1 初年度（PoC + 本番）

| プラットフォーム | PoC（3ヶ月） | 本番（年間） | 初年度合計 |
|----------------|--------------|------------|-----------|
| **Azure** | ¥36,278 | ¥118,996 | **¥155,274** |
| **GCP** | ¥36,454 | ¥62,989 | **¥99,443** |
| **AWS** | ¥218,450 | ¥256,880 | **¥475,330** |

### 4.2 2年目以降（本番のみ）

| プラットフォーム | 年額（JPY） | 月平均 | テスト1件あたり |
|----------------|------------|-------|---------------|
| **Azure** | ¥118,996 | ¥9,916 | ¥66 |
| **GCP** | ¥62,989 | ¥5,249 | ¥35 |
| **AWS** | ¥256,880 | ¥21,407 | ¥143 |

### 4.3 3年間TCO（Total Cost of Ownership）

| プラットフォーム | 初年度 | 2年目 | 3年目 | 3年TCO |
|----------------|-------|-------|-------|--------|
| **Azure** | ¥155,274 | ¥118,996 | ¥118,996 | **¥393,266** |
| **GCP** | ¥99,443 | ¥62,989 | ¥62,989 | **¥225,421** |
| **AWS** | ¥475,330 | ¥256,880 | ¥256,880 | **¥989,090** |

---

## 5. コスト最適化オプション

### 5.1 LLMモデル選択によるコスト影響（本番年間）

#### Azure（AI Foundry経由）

| モデル | 入力単価(/1M) | 出力単価(/1M) | 年間LLMコスト | 精度影響 |
|-------|-------------|-------------|--------------|---------|
| **GPT-5.2** | ¥266 | ¥2,128 | **¥32,080**（基準） | 高精度 |
| GPT-5-mini | ¥38 | ¥304 | ¥4,582 (-86%) | 良好 |
| GPT-5-nano | ¥7.6 | ¥61 | ¥918 (-97%) | やや低下（推論型） |

#### GCP（Vertex AI）

| モデル | 入力単価(/1M) | 出力単価(/1M) | 年間LLMコスト | 精度影響 |
|-------|-------------|-------------|--------------|---------|
| **Gemini 3 Pro Preview** | ¥304 | ¥1,824 | **¥32,285**（基準） | 最高精度（Preview） |
| Gemini 2.5 Pro | ¥190 | ¥1,520 | **¥22,914** (-29%) | 高精度（GA安定版） |
| **Gemini 3 Flash Preview** | ¥76 | ¥456 | **¥8,078** (-75%) | 良好（低コスト推奨） |
| Gemini 2.5 Flash | ¥22.8 | ¥91.2 | ¥2,093 (-94%) | やや低下 |

#### AWS（Bedrock）

| モデル | 入力単価(/1M) | 出力単価(/1M) | 年間LLMコスト | 精度影響 |
|-------|-------------|-------------|--------------|---------|
| **Claude Opus 4.6** | ¥760 | ¥3,800 | **¥75,240**（基準） | 最高精度（1Mトークン対応） |
| **Claude Sonnet 4.5** | ¥456 | ¥2,280 | **¥45,144** (-40%) | 高精度（バランス推奨） |
| Claude Haiku 4.5 | ¥152 | ¥760 | **¥15,048** (-80%) | 標準精度 |

### 5.2 処理設定によるコスト影響（Azure GPT-5.2基準）

| 最適化オプション | LLMコスト | OCRコスト | 年間合計 | 精度影響 |
|----------------|----------|----------|---------|---------|
| **標準構成（基準）** | ¥32,080 | ¥21,888 | **¥118,996** | 最高 |
| セルフリフレクション無効化 | ¥19,248 (-40%) | ¥21,888 | ¥106,164 | やや低下 |
| テキストPDFのOCRスキップ | ¥32,080 | ¥15,322 (-30%) | ¥112,430 | 同等 |
| GPT-5-nano + リフレクション無効 | ¥551 (-98%) | ¥21,888 | ¥87,467 | 低下 |
| 全最適化適用 | ¥551 | ¥15,322 | ¥80,901 (-32%) | 低下 |

> **注:** 1,328件/年の規模では、LLMコストよりもインフラ固定費（Entra ID P1 + APIM等）の
> 影響が大きいため、LLM最適化による総コスト削減効果は限定的です。

### 5.3 低コストモデル使用時のプラットフォーム別見積もり（本番年間）

| 構成 | LLMコスト | OCRコスト | インフラ | 年間合計 |
|-----|----------|----------|---------|---------|
| **Azure GPT-5-nano** | ¥918 | ¥21,888 | ¥65,028 | **¥87,834** |
| **GCP Gemini 3 Flash** | ¥8,078 | ¥21,888 | ¥8,816 | **¥38,782** |
| **AWS Claude Haiku 4.5** | ¥15,048 | ¥169,480 | ¥12,160 | **¥196,688** |

---

## 6. 推奨構成

### 6.1 コスト最優先の場合

| 項目 | 推奨 | 備考 |
|-----|------|------|
| プラットフォーム | **GCP** | |
| LLMモデル | Gemini 3 Flash Preview | 低コスト、十分な精度 |
| OCR | Document AI (Layout Parser) | 全言語ネイティブ対応 |
| セルフリフレクション | 無効化（MAX_REVISIONS=0） | |
| **初年度予算** | **約¥60,000** | |
| **年間運用予算** | **約¥39,000** | |

### 6.2 精度最優先の場合

| 項目 | 推奨 | 備考 |
|-----|------|------|
| プラットフォーム | **AWS** | |
| LLMモデル | Claude Opus 4.6 | Anthropic最高性能、1Mトークン対応 |
| OCR | YomiToku-Pro + Textract + Tesseract | 日本語OCR最高品質 |
| セルフリフレクション | 有効（MAX_REVISIONS=1） | |
| **初年度予算** | **約¥475,000** | |
| **年間運用予算** | **約¥257,000** | |

### 6.3 バランス型（推奨）

| 項目 | 推奨 | 備考 |
|-----|------|------|
| プラットフォーム | **Azure** または **GCP** | |
| LLMモデル | GPT-5.2（Azure）/ Gemini 3 Pro Preview（GCP） | 高精度 |
| OCR | Document Intelligence / Document AI | 全言語一元管理 |
| セルフリフレクション | 有効（MAX_REVISIONS=1） | |
| **初年度予算（Azure）** | **約¥155,000** | Microsoft環境との親和性 |
| **年間運用予算（Azure）** | **約¥119,000** | |
| **初年度予算（GCP）** | **約¥100,000** | コスト効率重視 |
| **年間運用予算（GCP）** | **約¥63,000** | |

### 6.4 プラットフォーム選定マトリクス

| 評価軸 | Azure | GCP | AWS |
|--------|-------|-----|-----|
| 初年度コスト | B | **A** | C |
| 年間運用コスト | B | **A** | C |
| LLM精度 | A | A | **S** |
| OCR品質（日本語） | A | A | **S**（YomiToku） |
| OCR運用簡易性 | **A** | **A** | C（3プロバイダー） |
| Microsoft連携 | **S** | C | C |
| 将来モデル対応 | **A** | A | A |
| 運用・保守性 | **A** | A | B |

> S=最優秀 A=優秀 B=良好 C=可

---

## 7. 予算取り推奨額（余裕を持たせた金額）

### 7.1 PoC予算（2-3ヶ月）

予算申請では、想定外のコスト増に対応できるよう、**実測値の1.5倍**を推奨します。

| プラットフォーム | 実測見積もり | **予算取り推奨額** | バッファ | 備考 |
|----------------|------------|------------------|---------|------|
| **Azure** | ¥36,278 | **¥55,000** | +52% | 環境構築・再実行・追加検証を考慮 |
| **GCP** | ¥36,454 | **¥55,000** | +51% | 同上 |
| **AWS** | ¥218,450 | **¥330,000** | +51% | SageMaker固定費含む |

**推奨：** PoC予算は **¥55,000（Azure/GCP）** または **¥330,000（AWS）** で申請

### 7.2 本番環境予算（年間）

本番環境では、以下を考慮した予算を推奨します：
- 実測データ量の変動（±20%）
- LLMモデル価格改定リスク
- 追加テスト・再テストの余裕

| プラットフォーム | 実測見積もり | **予算取り推奨額** | バッファ | 備考 |
|----------------|------------|------------------|---------|------|
| **Azure (標準)** | ¥118,996 | **¥160,000** | +34% | Entra ID P1 + APIM込み |
| **Azure (Free AD)** | ¥64,276 | **¥85,000** | +32% | Entra ID Free使用時 |
| **GCP** | ¥62,989 | **¥90,000** | +43% | 最もコスト効率が良い |
| **AWS** | ¥256,880 | **¥350,000** | +36% | SageMaker固定費除く |
| **AWS (SageMaker込)** | ¥636,880 | **¥850,000** | +33% | YomiToku-Pro年間固定費込み |

**推奨：** 本番環境予算は **¥90,000（GCP）** または **¥160,000（Azure）** で申請

### 7.3 初年度総額（PoC + 本番）

| プラットフォーム | 実測見積もり | **予算取り推奨額** | 備考 |
|----------------|------------|------------------|------|
| **Azure** | ¥155,274 | **¥210,000** | バランス型・推奨 |
| **GCP** | ¥99,443 | **¥140,000** | 最低コスト |
| **AWS** | ¥475,330 | **¥650,000** | 最高精度（SageMaker込み） |

### 7.4 3年間TCO予算

| プラットフォーム | 実測見積もり | **予算取り推奨額** | 備考 |
|----------------|------------|------------------|------|
| **Azure** | ¥393,266 | **¥500,000** | Microsoft環境統合 |
| **GCP** | ¥225,421 | **¥300,000** | 最もコスト効率が良い |
| **AWS** | ¥989,090 | **¥1,300,000** | 日本語OCR最高品質 |

### 7.5 推奨構成別予算（本番年間・予算取り用）

#### パターンA: コスト最優先

| 項目 | 内容 |
|-----|------|
| プラットフォーム | GCP |
| LLMモデル | Gemini 3 Flash Preview |
| セルフリフレクション | 無効（MAX_REVISIONS=0） |
| 実測見積もり | ¥38,782 |
| **予算申請額** | **¥55,000** |

#### パターンB: バランス型（推奨）

| 項目 | Azure | GCP |
|-----|-------|-----|
| LLMモデル | GPT-5.2 | Gemini 3 Pro Preview |
| セルフリフレクション | 有効 | 有効 |
| 実測見積もり | ¥118,996 | ¥62,989 |
| **予算申請額** | **¥160,000** | **¥90,000** |

#### パターンC: 精度最優先

| 項目 | 内容 |
|-----|------|
| プラットフォーム | AWS |
| LLMモデル | Claude Opus 4.6 |
| OCR | YomiToku-Pro（SageMaker） |
| セルフリフレクション | 有効 |
| 実測見積もり | ¥256,880（固定費除く） |
| **予算申請額** | **¥350,000**（固定費除く） or **¥850,000**（固定費込み） |

### 7.6 LLMモデル選択ガイド（最新版）

#### 高精度モデル（本番推奨）

| モデル | プラットフォーム | 1,800件年間コスト | 特徴 | 推奨用途 |
|-------|----------------|----------------|------|---------|
| **Claude Opus 4.6** | AWS | ¥75,240 | 1Mトークンコンテキスト、最高精度 | 複雑な監査項目 |
| **GPT-5.2** | Azure | ¥32,080 | バランス型、高精度 | 標準的な監査 |
| **Gemini 3 Pro** | GCP | ¥32,285 | Preview版、高精度 | 最新技術試用 |

#### 低コストモデル（PoC/開発推奨）

| モデル | プラットフォーム | 1,800件年間コスト | 削減率 | 推奨用途 |
|-------|----------------|----------------|--------|---------|
| **Gemini 2.5 Flash** | GCP | ¥2,093 | -94% | PoC初期検証 |
| **GPT-5-nano** | Azure | ¥918 | -97% | 開発・テスト |
| **Claude Haiku 4.5** | AWS | ¥15,048 | -80% | 大量処理 |
| **Gemini 3 Flash** | GCP | ¥8,078 | -75% | バランス型PoC |
| **Claude Sonnet 4.5** | AWS | ¥45,144 | -40% | 本番候補 |

#### モデル選択の判断基準

```
【本番環境】
┌─ 予算 > ¥100,000/年 ────┐
│  → Claude Opus 4.6 (AWS)  │  最高精度
│  → GPT-5.2 (Azure)        │  バランス
│  → Gemini 3 Pro (GCP)     │  最新技術
└──────────────────────────┘

┌─ 予算 ¥50,000-100,000/年 ┐
│  → Gemini 3 Pro (GCP)     │  高精度・低コスト
│  → Claude Sonnet 4.5(AWS) │  バランス
│  → GPT-5-mini (Azure)     │  コスト削減
└──────────────────────────┘

┌─ 予算 < ¥50,000/年 ──────┐
│  → Gemini 3 Flash (GCP)   │  推奨
│  → Claude Haiku 4.5 (AWS) │  標準
│  → GPT-5-nano (Azure)     │  超低コスト
└──────────────────────────┘

【PoC環境】
  → Gemini 2.5 Flash (GCP)
  → Gemini 3 Flash (GCP)
  → GPT-5-nano (Azure)
```

### 7.7 予算申請時の注意事項

1. **PoC予算の確保**
   - PoC期間中は**3回スプリント繰り返し**があるため、基本処理量の約3倍のコストを見込む
   - 開発・環境構築での試行錯誤を考慮し、**+50%以上**のバッファを推奨

2. **本番予算の変動要因**
   - 処理件数の変動（±20%）
   - LLMモデル価格改定（年1-2回）
   - OCRページ数の変動（文書種類による）

3. **コスト削減の余地**
   - セルフリフレクション無効化で **約30%削減**
   - 低コストモデル利用で **最大97%削減**
   - テキストPDF OCRスキップで **OCRコスト30%削減**

4. **推奨予算構成**
   ```
   初年度:
     PoC (3ヶ月):      ¥55,000  (GCP/Azure)
     本番 (年間):      ¥90,000  (GCP) / ¥160,000 (Azure)
     ────────────────────────────
     合計:           ¥145,000 / ¥215,000

   2年目以降 (年間):  ¥90,000 / ¥160,000
   ```

---

# Part 8: 監視サービスコスト詳細（Phase 3対応）

## 8.1 概要

Phase 3（監視最適化）で追加された監視サービスのコスト詳細です。

### 8.1.1 実装内容

| 項目 | 内容 |
|------|------|
| **監視基盤** | OpenTelemetry + プラットフォーム固有SDK |
| **Azure** | Application Insights（10%サンプリング） |
| **AWS** | X-Ray + CloudWatch Logs/Metrics |
| **GCP** | Cloud Logging + Cloud Trace（10%サンプリング） |
| **カスタムメトリクス** | document_processing_total, ocr_duration_ms, llm_api_calls_total, error_rate |
| **分散トレース** | 相関IDベース、依存関係マップ可視化 |

### 8.1.2 コスト最適化戦略

- **サンプリング**: トレースを10%サンプリングしてコスト削減
- **無料枠活用**: 各プラットフォームの無料枠を最大限活用
- **ログ保持期間**: 30日に制限（長期保存が必要な場合のみ延長）
- **Log-based Metrics**: GCPではCloud Loggingから自動生成

---

## 8.2 Azure 監視コスト

### 8.2.1 Application Insights

**年間処理量: 1,328件**

| リソース | 単価 | 使用量 | 月額コスト | 年間コスト | 備考 |
|---------|------|--------|-----------|-----------|------|
| **データ取り込み** | $2.88/GB | 0.5 GB/月 | $1.44 | $17.28 | 無料枠5GB/月内 |
| **ログ保持（30日超）** | $0.12/GB/月 | 0 GB | $0.00 | $0.00 | 30日以内は無料 |
| **Live Metrics Stream** | 無料 | - | $0.00 | $0.00 | リアルタイム監視 |
| **Smart Detection** | 無料 | - | $0.00 | $0.00 | 異常検知 |
| **合計** | | | **$1.44** | **$17.28** | **¥2,627** |

**無料枠:**
- データ取り込み: 最初の5GB/月は無料
- 年間1,328件の処理では無料枠内に収まる見込み

### 8.2.2 Azure Monitor（オプション）

| リソース | 単価 | 使用量 | 月額コスト | 年間コスト |
|---------|------|--------|-----------|-----------|
| **カスタムメトリクス** | $0.50/1M API呼び出し | 0.1M/月 | $0.05 | $0.60 |
| **アラート** | $0.10/アラート | 5アラート | $0.50 | $6.00 |
| **合計** | | | **$0.55** | **$6.60 (¥1,003)** |

### 8.2.3 Azure 監視合計

| 項目 | 月額 | 年額（USD） | 年額（JPY） |
|------|------|------------|------------|
| Application Insights | $1.44 | $17.28 | ¥2,627 |
| Azure Monitor（オプション） | $0.55 | $6.60 | ¥1,003 |
| **合計** | **$1.99** | **$23.88** | **¥3,630** |

---

## 8.3 AWS 監視コスト

### 8.3.1 AWS X-Ray

**年間処理量: 1,328件**

| リソース | 単価 | 使用量 | 月額コスト | 年間コスト | 備考 |
|---------|------|--------|-----------|-----------|------|
| **トレース記録** | $5.00/100万トレース | 0.0011M/月 | $0.01 | $0.07 | 無料枠100万/月 |
| **トレース取得** | $0.50/100万トレース | 0.0011M/月 | $0.00 | $0.00 | 無料枠内 |
| **合計** | | | **$0.01** | **$0.07** | **¥11** |

**無料枠:**
- 最初の100万トレース/月は無料（記録）
- 最初の100万トレース/月は無料（取得）
- 年間1,328件 × 3スパン = 約4,000トレース → 無料枠内

### 8.3.2 CloudWatch Logs

| リソース | 単価 | 使用量 | 月額コスト | 年間コスト |
|---------|------|--------|-----------|-----------|
| **ログ取り込み** | $0.50/GB | 0.3 GB/月 | $0.15 | $1.80 |
| **ログ保存（30日）** | $0.03/GB/月 | 0.3 GB | $0.01 | $0.11 |
| **Logs Insights クエリ** | $0.005/GB スキャン | 0.1 GB/月 | $0.00 | $0.01 |
| **合計** | | | **$0.16** | **$1.92 (¥292)** |

### 8.3.3 CloudWatch Metrics

| リソース | 単価 | 使用量 | 月額コスト | 年間コスト |
|---------|------|--------|-----------|-----------|
| **カスタムメトリクス** | $0.30/メトリクス | 10メトリクス | $3.00 | $36.00 |
| **API呼び出し** | $0.01/1,000呼び出し | 1,000/月 | $0.01 | $0.12 |
| **合計** | | | **$3.01** | **$36.12 (¥5,490)** |

### 8.3.4 AWS 監視合計

| 項目 | 月額 | 年額（USD） | 年額（JPY） |
|------|------|------------|------------|
| X-Ray | $0.01 | $0.07 | ¥11 |
| CloudWatch Logs | $0.16 | $1.92 | ¥292 |
| CloudWatch Metrics | $3.01 | $36.12 | ¥5,490 |
| **合計** | **$3.18** | **$38.11** | **¥5,793** |

---

## 8.4 GCP 監視コスト

### 8.4.1 Cloud Logging

**年間処理量: 1,328件**

| リソース | 単価 | 使用量 | 月額コスト | 年間コスト | 備考 |
|---------|------|--------|-----------|-----------|------|
| **ログ取り込み** | $0.50/GiB | 0.25 GiB/月 | $0.13 | $1.50 | 最初の50GiB/月無料 |
| **ログ保存（30日）** | $0.01/GiB/月 | 0 GiB | $0.00 | $0.00 | 30日以内は無料 |
| **合計** | | | **$0.13** | **$1.50** | **¥228** |

**無料枠:**
- 最初の50GiB/月の取り込みは無料 → 実質無料

### 8.4.2 Cloud Trace

| リソース | 単価 | 使用量 | 月額コスト | 年間コスト | 備考 |
|---------|------|--------|-----------|-----------|------|
| **トレース取り込み** | $0.20/100万スパン | 0.004M/月 | $0.00 | $0.01 | 最初の250万スパン/月無料 |
| **合計** | | | **$0.00** | **$0.01** | **¥1** |

**無料枠:**
- 最初の250万スパン/月は無料
- 年間1,328件 × 3スパン = 約4,000スパン → 無料枠内

### 8.4.3 Cloud Monitoring

| リソース | 単価 | 使用量 | 月額コスト | 年間コスト |
|---------|------|--------|-----------|-----------|
| **カスタムメトリクス（Log-based）** | 無料 | - | $0.00 | $0.00 |
| **API呼び出し** | $0.01/1,000呼び出し | 100/月 | $0.00 | $0.01 |
| **合計** | | | **$0.00** | **$0.01 (¥2)** |

### 8.4.4 GCP 監視合計

| 項目 | 月額 | 年額（USD） | 年額（JPY） |
|------|------|------------|------------|
| Cloud Logging | $0.13 | $1.50 | ¥228 |
| Cloud Trace | $0.00 | $0.01 | ¥2 |
| Cloud Monitoring | $0.00 | $0.01 | ¥2 |
| **合計** | **$0.13** | **$1.52** | **¥231** |

---

## 8.5 プラットフォーム別監視コスト比較

### 8.5.1 年間1,328件処理時の監視コスト

| プラットフォーム | 月額（USD） | 年額（USD） | 年額（JPY） | 無料枠活用 |
|----------------|------------|------------|------------|-----------|
| **GCP** | $0.13 | $1.52 | ¥231 | ✅ ほぼ無料枠内 |
| **Azure** | $1.99 | $23.88 | ¥3,630 | ⚠️ 一部有料 |
| **AWS** | $3.18 | $38.11 | ¥5,793 | ⚠️ メトリクスが有料 |

**結論:**
- **GCP が最も低コスト**（無料枠が最も充実）
- Azure は Application Insights の無料枠（5GB/月）を活用
- AWS は CloudWatch Metrics のコストが高い（カスタムメトリクス1個あたり$0.30/月）

### 8.5.2 監視機能比較

| 機能 | Azure | AWS | GCP |
|------|-------|-----|-----|
| **分散トレース** | ✅ Application Insights | ✅ X-Ray | ✅ Cloud Trace |
| **カスタムメトリクス** | ✅ Azure Monitor | ✅ CloudWatch Metrics | ✅ Cloud Monitoring（Log-based） |
| **ログ検索** | ✅ Log Analytics | ✅ CloudWatch Logs Insights | ✅ Cloud Logging |
| **異常検知** | ✅ Smart Detection | ⚠️ CloudWatch Anomaly Detection | ⚠️ 手動設定 |
| **依存関係マップ** | ✅ Application Map | ✅ Service Map | ✅ Trace List |
| **リアルタイム監視** | ✅ Live Metrics | ⚠️ CloudWatch Live Tail | ⚠️ Logs Explorer |

---

## 8.6 総合コスト影響

### 8.6.1 Phase 3 監視追加後の年間コスト（1,328件処理）

| プラットフォーム | Phase 2までのコスト | 監視コスト追加 | Phase 3後の合計 | 増加率 |
|----------------|-------------------|--------------|----------------|--------|
| **Azure** | ¥115,366 | +¥3,630 | **¥118,996** | +3.1% |
| **AWS** | ¥251,087 | +¥5,793 | **¥256,880** | +2.3% |
| **GCP** | ¥62,758 | +¥231 | **¥62,989** | +0.4% |

**Phase 2までのコスト内訳（再掲）:**
- Azure: Functions + AI Foundry + Document Intelligence + APIM + Key Vault + Storage
- AWS: Lambda + Bedrock + Textract + API Gateway + Secrets Manager + S3
- GCP: Cloud Functions + Vertex AI + Document AI + Cloud Storage（Apigee無効）

### 8.6.2 監視コストの推移予測

#### 処理件数別の監視コスト（年間）

| 処理件数/年 | Azure（JPY） | AWS（JPY） | GCP（JPY） |
|-----------|------------|-----------|-----------|
| **1,328件** | ¥3,630 | ¥5,793 | ¥231 |
| **5,000件** | ¥9,950 | ¥21,800 | ¥231 |
| **10,000件** | ¥19,900 | ¥43,600 | ¥560 |
| **20,000件** | ¥39,800 | ¥87,200 | ¥1,120 |

**スケーリング特性:**
- **GCP**: 無料枠が広いため、2万件までほぼ定額
- **Azure**: データ量に比例して増加（5GB/月超過後）
- **AWS**: カスタムメトリクス数に比例（リニアに増加）

---

## 8.7 コスト最適化の推奨事項

### 8.7.1 短期的な最適化（即座に実施可能）

| 最適化策 | 対象 | 削減効果 | 実施難易度 |
|---------|------|---------|-----------|
| **サンプリング率を10% → 5%に下げる** | 全プラットフォーム | -50% | 低 |
| **ログ保持期間を30日 → 7日に短縮** | Azure/AWS | -70% | 低 |
| **カスタムメトリクス数を削減（10 → 5個）** | AWS | -50% | 中 |
| **Log-based Metricsを活用** | GCP | 追加コストなし | 中 |

### 8.7.2 長期的な最適化（システム改修必要）

| 最適化策 | 削減効果 | 実施コスト |
|---------|---------|-----------|
| **エラーログのみ詳細記録** | -30% | 中 |
| **バッチ処理時のログ抑制** | -20% | 低 |
| **定期的なログアーカイブ（S3/Blob）** | -40%（長期保存コスト） | 高 |

### 8.7.3 無料枠を最大限活用する設定

#### Azure Application Insights
```python
# サンプリング設定（10%）
from opentelemetry.trace import sampling
sampler = sampling.ParentBasedTraceIdRatioBased(0.1)
```

#### AWS X-Ray
```python
# X-Ray SDK サンプリング設定
from aws_xray_sdk.core import xray_recorder
xray_recorder.configure(sampling=False)  # カスタムルール適用
```

#### GCP Cloud Trace
```python
# OpenCensus サンプリング設定（10%）
from opencensus.trace.samplers import ProbabilitySampler
sampler = ProbabilitySampler(0.1)
```

---

## 8.8 監視コストの予算配分

### 8.8.1 推奨予算構成（年間1,328件処理）

```
【Azure】
  コア処理:     ¥115,366  (93.2%)
  監視:         ¥3,630    (2.9%)
  予備費:       ¥4,800    (3.9%)
  ────────────────────────
  合計:         ¥123,796

【AWS】
  コア処理:     ¥251,087  (93.2%)
  監視:         ¥5,793    (2.2%)
  予備費:       ¥12,400   (4.6%)
  ────────────────────────
  合計:         ¥269,280

【GCP】
  コア処理:     ¥62,758   (97.6%)
  監視:         ¥231      (0.4%)
  予備費:       ¥1,300    (2.0%)
  ────────────────────────
  合計:         ¥64,289
```

### 8.8.2 監視コストのROI

| メリット | 定量的効果 | 年間削減額 |
|---------|-----------|-----------|
| **障害検知時間の短縮** | 平均30分 → 5分 | ¥120,000（作業時間削減） |
| **デバッグ時間の削減** | 平均2時間 → 30分 | ¥180,000（エンジニア工数） |
| **監査対応の効率化** | 証跡収集時間 -70% | ¥80,000（監査対応工数） |
| **合計削減効果** | | **¥380,000/年** |

**ROI計算:**
- 投資: ¥231 ~ ¥5,793/年（監視コスト）
- 削減効果: ¥380,000/年
- **ROI: 7,300% ~ 190,000%**

---

**改訂履歴**

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.0 | 2025年1月 | 初版作成（Azure のみ） |
| 1.1 | 2025年1月 | 監視・ログリソース追加、規模別見積もり更新 |
| 2.0 | 2025年1月 | マルチクラウド対応（GCP、AWS追加）、プラットフォーム比較追加 |
| 3.0 | 2026年2月 | Part 5全面改訂: 本番=年間件数に修正、大量エビデンス対応(8ページ/件)、リソース網羅的明細化、3年TCO追加 |
| 4.0 | 2026年2月 | LLMモデル最新化(GPT-5.2/Gemini 2.5/Claude Sonnet 4.5)、実績データ反映(1,328件/3.2GB)、全コスト再計算 |
| 5.0 | 2026年2月 | Gemini 3 Pro/Flash・Claude Opus 4.6に更新、バッファ×1.3に拡大、低コストモデル比較追加、AWS OCR(YomiToku/Tesseract)詳細化 |
| 6.0 | 2026年2月 | **PoC処理量を精緻化**（3回スプリント繰り返し明記）、**Part 7: 予算取り推奨額を追加**（余裕を持たせた金額）、最新LLMモデル詳細比較（Gemini 3/Claude Sonnet 4.5/Opus 4.6）、モデル選択ガイド追加 |
| 7.0 | 2026年2月 | **Part 8: 監視サービスコスト詳細を追加**（Phase 3対応）、Application Insights/X-Ray/Cloud Loggingコスト明細化、プラットフォーム別監視コスト比較、監視ROI分析（7,300%~190,000%）、無料枠活用ガイド、コスト最適化推奨事項追加 |
| 8.0 | 2026年2月 | APIM/Key Vaultを本番必須リソースに移動、構成整理 |
| 9.0 | 2026年2月12日 | **為替レート¥152/USD（2026/2/12時点）に更新**、全コスト再計算、Azure本番にAPIM明示追加（¥6,384/年）、Entra ID P1（¥54,720/年）反映、PoC（3ヶ月）・本番（年間）形式に統一、3年TCO・予算取り推奨額を更新 |
